(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[968],{3024:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var s=n(9268),a=n(1387),r=n(3658),l=n(4274),o=n(8399),i=n(8992),c=n(6564),d=n(5991),u=n(6006),h=n(2171),x=n(102),p=n(6662),m=n(4751);function j(){let{data:e}=(0,m.useSession)();if(e){var t;return(0,s.jsxs)(s.Fragment,{children:["관리모드 ",null===(t=e.user)||void 0===t?void 0:t.name," ",(0,s.jsx)("br",{}),(0,s.jsx)("button",{style:{backgroundColor:"#fb4ab0",color:"white",margin:5,padding:5,borderRadius:5},onClick:()=>(0,m.signOut)(),children:"햄 아웃"})]})}return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("button",{style:{backgroundColor:"#fb4ab0",color:"white",margin:5,padding:5,borderRadius:5},onClick:()=>(0,m.signIn)(),children:"햄 인"})})}let f=async e=>{let t=await fetch("/api/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t.ok?await t.json():(console.log("에러낫다! 스샷찍어주실?"),console.log(t),"")},b=async e=>{let t=await fetch("/api/request?id="+e._id+"&password="+e.password,{method:"DELETE",headers:{"Content-Type":"application/json"}});return t.ok?await t.json():(console.log("에러낫다! 스샷찍어주실?"),console.log(t),"")};async function g(){let e=await fetch("api/request",{next:{revalidate:1}});return e.ok?e.json():(console.log("에러낫다! 스샷찍어주실?"),console.log(e),[])}let w=e=>{let t=Math.floor(e/6e4);if(t<60)return"".concat(t,"분전");let n=Math.floor(t/60);return n<24?"".concat(n,"시간전"):"".concat(Math.floor(n/24),"일전")};function y(e){let{userData:t,requestData:n,session:y}=e,[v,Z]=(0,u.useState)(n),[k,C]=(0,u.useState)(""),[N,_]=(0,u.useState)(""),[S,q]=(0,u.useState)(""),E=t.map(e=>e.name),T=e=>{C(e.target.value.slice(0,50))},O=e=>{_(e.target.value)},I=async()=>{let e=await g();Z(e)},P=async()=>{if(!S||!k)return;let e=await f({requester:S,request:k,password:N});e?(Z([{requester:S,request:k,password:N,_id:e},...v]),C(""),_(""),q("")):await I()},W=async e=>{let t=await b(e);"success"===t?Z(v.filter(t=>t._id!==e._id)):await I()};return(0,u.useEffect)(()=>{let e=setInterval(()=>{I()},18e4);return()=>{clearInterval(e)}},[]),(0,s.jsxs)(o.Z,{component:d.Z,style:{minWidth:335},children:[(0,s.jsxs)(m.SessionProvider,{session:y,children:[(0,s.jsx)(j,{}),(0,s.jsxs)("div",{className:"search",style:{margin:20},children:[(0,s.jsx)(p.Z,{disablePortal:!0,id:"combo-box-gem",options:E,sx:{width:300},value:S,onChange:(e,t)=>{q(t||"")},renderInput:e=>(0,s.jsx)(h.Z,{...e,label:"케릭명"})}),(0,s.jsx)(h.Z,{style:{width:"100%"},multiline:!0,maxRows:"3",label:"해줘내용",variant:"outlined",value:k,onChange:T}),(0,s.jsx)(h.Z,{style:{width:"250px"},label:"비번",type:"password",variant:"outlined",onChange:O}),(0,s.jsx)(x.Z,{onClick:P,children:"요청"})]})]}),(0,s.jsxs)(a.Z,{className:"text-left text-sm font-light",children:[(0,s.jsx)(i.Z,{className:"border-b font-medium dark:border-neutral-500",children:(0,s.jsxs)(c.Z,{style:{backgroundColor:"#626262"},children:[(0,s.jsx)(l.Z,{style:{maxWidth:250},className:"px-2 py-4",children:"케릭명"}),(0,s.jsx)(l.Z,{className:"px-6 py-4",children:'"해줘"'}),(0,s.jsx)(l.Z,{className:"px-2 py-4",style:{width:150},children:"버튼"})]})}),(0,s.jsx)(r.Z,{children:v.map(e=>{let t=new Date(e.createdAt).getTime(),n=new Date().getTime()-t;return(0,s.jsxs)(c.Z,{className:"border-b dark:border-neutral-500",sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,s.jsx)(l.Z,{style:{maxWidth:250},className:"px-2 py-2",component:"th",scope:"row",children:e.requester}),(0,s.jsx)(l.Z,{style:{maxHeight:150,overflowY:"scroll"},className:"px-6 py-4 ",component:"th",scope:"row",children:(0,s.jsx)("pre",{style:{whiteSpace:"break-spaces"},children:e.request})}),(0,s.jsx)(l.Z,{style:{maxWidth:250},className:"px-2 py-4",component:"th",scope:"row",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(x.Z,{variant:"outlined",onClick:()=>{let t="@".concat(e.requester," 당신의 해줘:").concat(e.request," 내가 해줌!");navigator.clipboard.writeText(t).then(function(){alert("복사완료 : "+t)},function(e){alert("복사가 안됬어요. 직접연락해주세요.")})},children:"귓말복사"}),(0,s.jsx)(x.Z,{variant:"outlined",onClick:()=>{let t=prompt("삭제할거에요? 비번적어주세요");null!==t&&(console.log("row",e),W({...e,password:t}))},children:"삭제"}),(0,s.jsx)("div",{children:w(n)})]})})]},e._id)})})]})]})}},6806:function(e,t,n){Promise.resolve().then(n.bind(n,3024))}},function(e){e.O(0,[612,751,667,961,744],function(){return e(e.s=6806)}),_N_E=e.O()}]);